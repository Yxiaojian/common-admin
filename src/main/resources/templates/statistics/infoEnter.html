<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>课程--三问数学</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="/static/layui/css/layui.css" media="all"/>
    <link rel="stylesheet" href="/static/css/public.css" media="all"/>
    <style>
        .needspan label.error{
            float: left;
            margin-left: 108px;
        }
    </style>
</head>
<body class="childrenBody">
<!-- 弹出层开始 -->
<form class="layui-form studentform" id="studentForm">
    <input type="hidden" id="studentId" name="studentId">
    <div class="layui-tab layui-tab-brief">
        <div class="enrtitle">信息补录</div>
        <ul class="layui-tab-title">
            <i class="sticons icons-jcxx" style="margin-left: 20px;"></i>
            <li class="layui-this" lay-id="basicInfo" style="pointer-events: none;">基本信息</li>
        </ul>
        <div class="layui-tab-content" style="height: 100px;">
            <div class="layui-tab-item layui-show">
                <div class="layui-col-md8 layui-col-xs12" style="margin: 35px;">

                    <div class="layui-form-item posirea">
                        <label class="layui-form-label">姓名</label>
                        <div class="layui-input-block">
                            <input type="text" class="layui-input" required id="studentName" maxlength="256"
                                   name="studentName" placeholder="请输入姓名">
                        </div>
                        <span class="reqInfo" style="left: 50px;">*</span>
                    </div>
                    <div class="layui-form-item posirea">
                        <label class="layui-form-label">电话1</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" required id="phoneOne" maxlength="32"
                                   name="phoneOne" placeholder="电话号码">
                        </div>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" id="phoneOneRemark" maxlength="256" name="phoneOneRemark"
                                   placeholder="备注">
                        </div>
                        <span class="reqInfo" style="left: 45px;">*</span>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">性别</label>
                        <div class="layui-input-block">
                            <select class="state" name="sex" id="sexInfo">
                                <option value="1">男</option>
                                <option value="0">女</option>
                            </select>
                        </div>
                    </div>


                    <div class="layui-form-item">
                        <label class="layui-form-label">电话2</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" id="phoneTwo" maxlength="32" name="phoneTwo"
                                   placeholder="电话号码">
                        </div>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" id="phoneTwoRemark" maxlength="256" name="phoneTwoRemark"
                                   placeholder="备注">
                        </div>
                    </div>

                    <div class="layui-form-item posirea">
                        <label class="layui-form-label">学校</label>
                        <div class="layui-input-block">
                            <input type="text" class="layui-input" required id="school" maxlength="256" name="school"
                                   placeholder="请输入学校">
                        </div>
                        <span class="reqInfo" style="left: 50px;">*</span>
                    </div>

                    <div class="layui-form-item posirea">
                        <div class="layui-inline posirea" style="margin-right: 0;">
                            <label class="layui-form-label">年级</label>
                            <div class="layui-input-inline">
                                <select class="state" id="js_gradeSel"  lay-filter="js_gradeSel" name="grade">
                                    <option value="1">一年级</option>
                                    <option value="2">二年级</option>
                                    <option value="3">三年级</option>
                                    <option value="4">四年级</option>
                                    <option value="5">五年级</option>
                                    <option value="6">六年级</option>
                                </select>
                            </div>
                        </div>

                        <div class="layui-inline">
                            <label class="layui-form-label" style="padding-left: 0;width: 60px;">入学年份</label>
                            <div class="layui-input-inline" style="width: 110px;">
                                <input type="text" class="layui-input"  lay-filter="startYear" id="entranceYear" name="entranceYear"
                                       placeholder="">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">家庭小区</label>
                            <div class="layui-input-block">
                                <input type="text" class="layui-input" id="address" maxlength="256"
                                       name="address" placeholder="请输入家庭小区">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">生日</label>
                            <div class="layui-input-block">
                                <input type="text" class="layui-input" id="birthday" name="birthday" placeholder="生日">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">备注</label>
                            <div class="layui-input-block">
                                <textarea placeholder="请输入备注" id="remark" name="remark" class="layui-textarea"
                                          maxlength="256"></textarea>
                            </div>

                        </div>
                    </div>


                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <a class="layui-btn layui-bg-gray layui-layout-left js_return"
                               style="width:48%;left:0;" lay-filter="return">返回</a>
                            <a class="layui-btn  layui-layout-right js_infoEnterSubmit"
                               style="width:48%;" lay-filter="infoEnterSubmit">确认</a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</form>

<!--</div>-->
<!-- 转班弹出层结束 -->
<script type="text/javascript" src="/static/layui/layui.js"></script>
<script type="text/javascript" src="/static/js/jquery.js"></script>
<script type="text/javascript" src="/static/js/jquery.validate.js"></script>
<script type="text/javascript" src="/static/js/site.js"></script>
<script>
    layui.use(['form', 'layer'], function () {
        var form = layui.form,
            layer = parent.layer === undefined ? layui.layer : top.layer,
            $ = layui.jquery,
            table = layui.table;

        //重新渲染
        form.render('select');

        form.verify({
            money: function (val, item) {
                if (!/^\d+(\.\d{0,2})?$/.test(val)) {
                    return '请输入正确的格式'
                }
            }
        });

        //当你在iframe页面关闭自身时
        //var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
        //parent.layer.close(index,1231); //再执行关闭

        /*form.on("submit(return)", function (data) {
            alert("return");
            parent.location.reload();
        })

        form.on("submit(infoEnterSubmit)", function (data) {
            alert("infoEnterSubmit");
            parent.location.reload();
        })*/

        $(".js_return").on("click", function () {
            parent.location.reload();
        })

        $(".js_infoEnterSubmit").on("click", function () {
            if (!validBasicForm()) {
                return false;
            }
            var frm = $("#studentForm");
            console.log(document.getElementById("sexInfo").value);
            layer.confirm('确定修改学生信息？', {icon: 3, title: '提示信息'}, function (index) {
                layer.close(index);
                $.post("/student/update", frm.serialize(), function (res) {
                    if (res.data) {
                        //layer.close(index);
                        layer.msg("修改成功！");
                        setTimeout('parent.location.reload();', 1000);
                    } else {
                        layer.msg(res.msg);
                    }
                })

            });


        })

        function validBasicForm() {
            var $validator = $("#studentForm").validate();
            if (!$validator.element($("#studentName"))) {
                return false;
            }
            if (!$validator.element($("#phoneOne"))) {
                return false;
            }
            if (!$validator.element($("#phoneOneRemark"))) {
                return false;
            }
            if (!$validator.element($("#phoneTwo"))) {
                return false;
            }
            if (!$validator.element($("#phoneTwoRemark"))) {
                return false;
            }
            if (!$validator.element($("#school"))) {
                return false;
            }
            return true;
        }






    })
</script>
</body>
</html>